{
	"name": "Create Views Reporting",
	"properties": {
		"content": {
			"query": "-- ==============================================================================\n-- Vistas de la capa Gold para el informe\n-- ==============================================================================\n\n-- Arreglar dateop en noteboobk\n\nCREATE OR ALTER VIEW fact.Sales AS \nSELECT  s.skSales,\n        s.idSales,\n        s.idArticles,\n        COALESCE(a.skArticles, -1) AS skArticles,\n        s.idWarehouse,\n        COALESCE(w.skWarehouse, -1) AS skWarehouse,\n        s.idClient,\n        COALESCE(cl.skClient, -1) AS skClient, \n        s.idPostalCode,\n        COALESCE(p.skPostalCode, -1) AS skPostalCode, \n        s.idCurrency,\n        COALESCE(cu.skCurrency, -1) AS skCurrency,\n        s.idTariff,\n        COALESCE(t.skTariff, -1) AS skTariff, \n        s.idOperationType,\n        COALESCE(o.skOperationType, -1) AS skOperationType,\n        s.idHours,\n        COALESCE(h.skHours, -1) AS skHours,\n        s.idDate,\n        COALESCE(d.skDate, -1) AS skDate,\n        s.date,\n        s.dateOp,\n        s.ticketNumber,\n        s.quantity,\n        s.unitPrice,\n        s.unitCost,\n        s.amtTotalEuros,\n        s.amtNetEuros,\n        s.amtTotalEurosDiscount,\n        s.amtNetEurosDiscount,\n        s.discountSale,\n        s.amtTotalDiscount,\n        s.amtNetDiscount,\n        s.loadDate,\n        s.deltaDate\nFROM gold.dbo.fact_Sales AS s\nLEFT JOIN [gold].[dbo].[dim_Articles] AS a\n    ON s.idArticles = a.idArticles AND s.dateOp BETWEEN a.fromDate AND a.toDate\nLEFT JOIN [gold].[dbo].[dim_Client] AS cl\n    ON s.idClient = cl.idClient AND s.dateOp BETWEEN cl.fromDate AND cl.toDate\nLEFT JOIN [gold].[dbo].[dim_Currency] AS cu\n    ON s.idCurrency = cu.idCurrency AND s.dateOp BETWEEN cu.fromDate AND cu.toDate\nLEFT JOIN [gold].[dbo].[dim_Date] AS d\n    ON s.idDate = d.idDate AND s.dateOp BETWEEN d.fromDate AND d.toDate\nLEFT JOIN [gold].[dbo].[dim_Hours] AS h\n    ON s.idHours = h.idHours AND s.dateOp BETWEEN h.fromDate AND h.toDate\nLEFT JOIN [gold].[dbo].[dim_OperationType] AS o\n    ON s.idOperationType = o.idOperationType AND s.dateOp BETWEEN o.fromDate AND o.toDate\nLEFT JOIN [gold].[dbo].[dim_PostalCode] AS p\n    ON s.idPostalCode = p.idPostalCode AND s.dateOp BETWEEN p.fromDate AND p.toDate\nLEFT JOIN [gold].[dbo].[dim_Tariff] AS t\n    ON s.idTariff = t.idTariff AND s.dateOp BETWEEN t.fromDate AND t.toDate\nLEFT JOIN [gold].[dbo].[dim_Warehouse] AS w\n    ON s.idWarehouse = w.idWarehouse AND s.dateOp BETWEEN w.fromDate AND w.toDate\n\n\nCREATE OR ALTER VIEW dim.Articles AS\n-- SELECT  -1 AS skarticles, \n--         -1 AS idarticles, \n--         'D' AS name, \n--         'D' AS description, \n--         'D' AS externalCode, \n--         'D' AS size, \n--         -1  AS numSize, \n--         'D' AS colour, \n--         'D' AS category, \n--         -1  AS codLine, \n--         'D' AS line, \n--         'D' AS season\n\n-- UNION \n\nSELECT  skarticles, \n        idarticles, \n        name, \n        description, \n        externalCode, \n        size, \n        numSize, \n        colour, \n        category, \n        codLine, \n        line, \n        season\nFROM gold.dbo.dim_articles;\n\nCREATE OR ALTER VIEW dim.Client AS\nSELECT  -1 AS skClient,\n        -1 AS idClient,\n        'D' AS name,\n        'D' AS lastName1,\n        'D' AS lastName2,\n        'D' AS email,\n        'D' AS phoneNumber,\n        'D' AS birthDay,\n        -1 AS age,\n        'D' AS gender,\n        'D' AS country,\n        'D' AS countryCode,\n        'D' AS region,\n        'D' AS address,\n        'D' AS postalCode,\n        0 AS active\nUNION\nSELECT  skClient,\n        idClient,\n        name,\n        lastName1,\n        lastName2,\n        email,\n        phoneNumber,\n        birthDay,\n        age,\n        gender,\n        country,\n        countryCode,\n        region,\n        address,\n        postalCode,\n        active\nFROM gold.dbo.dim_client\n\nCREATE OR ALTER VIEW dim.Currency AS\nSELECT  -1 AS skCurrency,\n        -1 AS idCurrency,\n        'D' AS name,\n        'D' AS currency\nUNION\nSELECT  skCurrency,\n        idCurrency,\n        name,\n        currency\nFROM gold.dbo.dim_currency\n\nCREATE OR ALTER VIEW dim.Date AS\nSELECT  -1 AS skDate,\n        -1 AS idDate,\n        -1 AS datekey,\n        CAST('1990-01-01' AS datetime2(7)) AS date,\n        'D' AS month,\n        -1 AS monthNumber,\n        -1 AS year,\n        -1 AS weekNumber,\n        'D' AS dayWeek,\n        -1 AS dayWeekNumber,\n        -1 AS yearDay,\n        'D' AS quarter,\n        'D' AS quadrimester,\n        'D' AS semester\nUNION\nSELECT  skDate,\n        idDate,\n        datekey,\n        date,\n        month,\n        monthNumber,\n        year,\n        weekNumber,\n        dayWeek,\n        dayWeekNumber,\n        yearDay,\n        quarter,\n        quadrimester,\n        semester\nFROM gold.dbo.dim_date\n\nCREATE OR ALTER VIEW dim.Hours AS\nSELECT  skHours,\n        idHours,\n        hour,\n        minute,\n        fullHour\nFROM gold.dbo.dim_hours\n\nCREATE OR ALTER VIEW dim.OperationType AS\nSELECT  skOperationType,\n        idOperationType,\n        operation\nFROM gold.dbo.dim_operationtype\n\nCREATE OR ALTER VIEW dim.PostalCode AS\nSELECT  skPostalCode,\n        idPostalCode,\n        postalCode,\n        region,\n        countryCode,\n        country\nFROM gold.dbo.dim_postalcode\n\nCREATE OR ALTER VIEW dim.Tariff AS\nSELECT  skTariff,\n        idTariff,\n        tariff\nFROM gold.dbo.dim_tariff\n\nCREATE OR ALTER VIEW dim.Warehouse AS\nSELECT  skWarehouse,\n        idWarehouse,\n        warehouse,\n        externalCode,\n        countryCode,\n        country,\n        city,\n        address,\n        description\nFROM gold.dbo.dim_warehouse",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "ReportingDB",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}