{
	"name": "Re-Load Gold CETAs",
	"properties": {
		"folder": {
			"name": "SCD"
		},
		"content": {
			"query": "\ndrop EXTERNAL TABLE [dim].[Articles]\n---------------\n-- Articles  --\n---------------\nCREATE  EXTERNAL TABLE GoldenlessDWH.[dim].[Articles]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Articles', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \nSELECT \n\t-1  AS idSkArticles,\n\t-1  AS idArticles,\n\t'D' AS name,\n\t'D' AS description,\n\t'D' AS externalcode,\n\t'D' AS size,\n\t-1  AS numSize,\n\t'D' AS colour,\n\t'D' AS category, \n\t'D' AS codLine,\n\t'D' AS line, \n\t'D' AS season, \n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-12-31' AS datetime2) AS toDate,\n\t1  AS isCurrent,\n\t19900101 AS loadDate,\n\t19900101 AS deltaDate,\n\tHASHBYTES('SHA2_256',('-1'+'D'+'D'+'D'+'D'+'-1'+'D'+'D'+'D'+'D'+'D')) AS [$hash]\nUNION\nSELECT *\nFROM [SilverlessSTG].[scd].[Articles]\nORDER BY idSkArticles\n\n\ndrop EXTERNAL TABLE [dim].[Currency]\n--------------\n-- Currency --\n--------------\n\nCREATE  EXTERNAL TABLE GoldenlessDWH.[dim].[Currency]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Currency', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \nSELECT \n\t\t-1  \t\t AS idSkCurrency, \n\t\t-1  \t\t AS idCurrency, \n\t\t'D' \t\t AS name,\n\t\t'D' \t\t AS currency,\t\t\t\t \t\t\t \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + 'D' + 'D')) AS [$hash]\nUNION\nSELECT *\nFROM [SilverlessSTG].[scd].[Currency]\nORDER BY idSkCurrency\n\n\n\n-- drop EXTERNAL TABLE [dim].[Date]\n----------\n-- Date --\n----------\n\nCREATE  EXTERNAL TABLE GoldenlessDWH.[dim].[Date]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Date', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \n\nSELECT \n\t\t-1  \t\t AS idSkDate, \n\t\t-1  \t\t AS idDate, \n\t\t-1 \t\t \t AS dateKey,\n\t\t'1990-01-01' AS date,\n\t\t'D'    \t     AS month, \n\t\t-1  \t\t AS monthNumber, \n\t\t-1 \t\t \t AS year,\n\t\t-1\t\t\t AS weekNumber,\n\t\t'D'    \t     AS dayWeek, \t\n\t\t-1\t\t\t AS dayWeekNumber, \n\t\t-1 \t\t \t AS yearDay,\n\t\t'D' \t\t AS quarter,\n\t\t'D'    \t     AS quadrimester, \t\n\t\t'D' \t\t AS semester, \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + '-1' + '1990-01-01' + 'D' + '-1' + '-1' + '-1' + 'D' + '-1' + '-1' + 'D' + 'D' + 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idDate) AS idSkDate,\n\tidDate,\n\tdateKey,\n\tdate,\n\tmonth,\n\tmonthNumber,\n\tyear,\n\tweekNumber,\n\tdayWeek,\n\tdayWeekNumber,\n\tyearDay,\n\tquarter,\n\tquadrimester,\n\tsemester,\n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idDate AS NVARCHAR) + CAST(dateKey AS NVARCHAR) + CAST(date AS NVARCHAR) + month)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_Date]\n\n\n-- drop EXTERNAL TABLE [dim].[Hours]\n-----------\n-- Hours --\n-----------\n\nCREATE  EXTERNAL TABLE GoldenlessDWH.[dim].[Hours]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Hours', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \n\nSELECT \n\t\t-1  \t\t AS idSkHours, \n\t\t-1  \t\t AS idHours, \n\t\t-1 \t\t \t AS hour,\n\t\t-1\t\t\t AS minute,\n\t\t'D'    \t     AS fullHour, \t \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + '-1' + '-1' + 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idHours) AS idSkHours,\n\tidHours,\n\thour,\n\tminute,\n\tfullHour,\n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idHours AS NVARCHAR) + CAST(hour AS NVARCHAR) + CAST(minute AS NVARCHAR) + fullHour)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_Hours]\n\n\n-- drop EXTERNAL TABLE [dim].[OperationType]\n-------------------\n-- OperationType --\n-------------------\n\nCREATE  EXTERNAL TABLE GoldenlessDWH.[dim].[OperationType]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/OperationType', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \n\nSELECT \n\t\t-1  \t\t AS idSkOperationType , \n\t\t-1  \t\t AS idOperationType , \n\t\t'D' \t\t AS operation,\t\t\t \t\t\t \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idOperationType) AS idSkOperationType,\n\tidOperationType,\n\toperation,\n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idOperationType AS NVARCHAR)+operation)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_OperationType]\n\n\n-- drop EXTERNAL TABLE [dim].[PostalCodes]\n-----------------\n-- PostalCodes --\n-----------------\n\nCREATE  EXTERNAL TABLE [dim].[PostalCodes]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/PostalCodes', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \nSELECT \n\t\t-1  \t\t AS idSkPostalCodes, \n\t\t-1  \t\t AS idpostalCode, \n\t\t'D' \t\t AS postalCodes,\n\t\t'D' \t\t AS region,\n\t\t'D' \t\t AS countryCode,\n\t\t'D' \t\t AS country,\t\t\t \t\t\t \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + '-1' + 'D' + 'D' + 'D' + 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idPostalCodes) AS idSkPostalCodes,\n\tidPostalCodes,\n\tpostalCode,\n\tregion,\n\tcountryCode,\n\tcountry,\n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idPostalCodes AS NVARCHAR)+postalCode+region+countryCode+country)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_PostalCodes]\n\n\n-- drop EXTERNAL TABLE [dim].[Tariff]\n------------\n-- Tariff --\n------------\n\nCREATE  EXTERNAL TABLE [dim].[Tariff]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Tariff', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \nSELECT \n\t\t-1  \t\t AS idSkTariff, \n\t\t-1  \t\t AS idTariff, \n\t\t'D' \t\t AS tariff, \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idTariff) AS idSkTariff,\n\tidTariff,\n\ttariff,\n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idTariff AS NVARCHAR)+tariff)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_Tariff]\n\n\n-- drop EXTERNAL TABLE [dim].[Warehouse]\n---------------\n-- Warehouse --\n---------------\n\nCREATE  EXTERNAL TABLE [dim].[Warehouse]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Warehouse', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \nSELECT \n\t\t-1  \t\t AS idSkWarehouse, \n\t\t-1  \t\t AS idWarehouse, \n\t\t'D' \t\t AS warehouse, \n\t\t'D' \t\t AS externalcode, \n\t\t'D' \t\t AS countryCode, \n\t\t'D' \t\t AS country, \n\t\t'D' \t\t AS city, \n\t\t'D' \t\t AS address, \n\t\t'D' \t\t AS description, \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 \t\t\t AS isCurrent, \n\t\t19900101 \t AS loadDate, \n\t\t19900101 \t AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + '-1' + 'D' + 'D' + 'D' + 'D' + 'D' + 'D'+ 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idWarehouse) AS idSkWarehouse,\n\tidWarehouse,\n\twarehouse,\n\texternalcode,\n\tcountryCode,\n\tcountry,\n\tcity,\n\taddress,\n\tdescription,  \n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idWarehouse AS NVARCHAR)+warehouse+externalcode+countryCode+country+city+address+description)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_Warehouse]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "GoldenlessDWH",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}