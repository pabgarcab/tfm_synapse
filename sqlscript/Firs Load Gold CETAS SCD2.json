{
	"name": "Firs Load Gold CETAS SCD2",
	"properties": {
		"folder": {
			"name": "SCD"
		},
		"content": {
			"query": "-- drop EXTERNAL TABLE [dim].[Warehouse]\nCREATE  EXTERNAL TABLE [dim].[Warehouse]\nWITH\n(\n\tLOCATION = 'gold/Dimensions/Warehouse', \n\tDATA_SOURCE = datalake1pgc,\n\tFILE_FORMAT = ParquetFileFormat\n) AS \nSELECT \n\t\t-1 AS idSkWarehouse, \n\t\t-1 AS idWarehouse, \n\t\t'D' AS warehouse, \n\t\t'D' AS externalcode, \n\t\t'D' AS countryCode, \n\t\t'D' AS country, \n\t\t'D' AS city, \n\t\t'D' AS address, \n\t\t'D' AS description, \n\t\t'1990-01-01' AS fromDate,\n\t\t'9999-12-31' AS toDate,\n\t\t1 AS isCurrent, \n\t\t20241010 AS loadDate, \n\t\t20241010 AS deltaDate, \n\t\tHASHBYTES('SHA2_256',('-1' + '-1' + 'D' + 'D' + 'D' + 'D' + 'D' + 'D'+ 'D')) AS [$hash]\n\nUNION\n\nSELECT \n\tROW_NUMBER () OVER (ORDER BY idWarehouse) AS idSkWarehouse,\n\tidWarehouse,\n\twarehouse,\n\texternalcode,\n\tcountryCode,\n\tcountry,\n\tcity,\n\taddress,\n\tdescription,  \n\tCAST('1990-01-01' AS datetime2) AS fromDate,\n\tCAST('9999-01-01' AS datetime2) AS toDate,\n\t1 isCurrent,\n\tloadDate,\n\tdeltaDate,\n\tHASHBYTES('SHA2_256',(CAST(idWarehouse AS NVARCHAR)+warehouse+externalcode+countryCode+country+city+address+description)) AS [$hash]\nFROM\n\t[SilverlessSTG].[etl].[vw_dim_Warehouse]\n\n\n-- drop EXTERNAL TABLE [dim].[Articles]\n-- CREATE  EXTERNAL TABLE GoldenlessDWH.[dim].[Articles]\n-- WITH\n-- (\n-- \tLOCATION = 'gold/Dimensions/Articles', \n-- \tDATA_SOURCE = datalake1pgc,\n-- \tFILE_FORMAT = ParquetFileFormat\n-- ) AS \n\n-- SELECT \n-- \tROW_NUMBER () OVER (ORDER BY idWarehouse) idSkWarehouse,\n-- \tidWarehouse,\n-- \twarehouse,\n-- \texternalcode,\n-- \tcountryCode,\n-- \tcountry,\n-- \tcity,\n-- \taddress,\n-- \tdescription,  \n-- \tCAST('1990-01-01' AS datetime2) AS fromDate,\n-- \tCAST('9999-01-01' AS datetime2) AS toDate,\n-- \t1 isCurrent,\n-- \tloadDate,\n-- \tdeltaDate,\n-- \tHASHBYTES('SHA2_256',(CAST(idWarehouse AS NVARCHAR)+warehouse+externalcode+countryCode+country+city+address+description)) AS [$hash]\n-- FROM\n-- \t[SilverlessSTG].[etl].[vw_dim_Articles]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "GoldenlessDWH",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}